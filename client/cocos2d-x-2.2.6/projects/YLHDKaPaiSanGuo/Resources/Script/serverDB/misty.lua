-- Description: auto-created by ExcelToLua tool.
-- Author:jjc

module("misty", package.seeall)


keys = {
	"ï»¿ID", "MistType", "CityID", "ArmyID", "ArmyNum", "MistyID", "MistyCityID1", "MistyCityID2", "MistyCityID3", "MistyCityID4", "MistyCityID5", "MistyCityID6", "MistyCityID7", "MistyCityID8", "MistyCityID9", "MistyCityID10", "ResIcon", 
}

mistyTable = {
    id_1 = {"1", "60", "120101", "4", "1", "61", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_2 = {"1", "58", "120102", "4", "2", "59", "0", "0", "0", "0", "0", "0", "0", "0", "0", "17", },
    id_3 = {"1", "38", "120203", "4", "3", "39", "40", "0", "0", "0", "0", "0", "0", "0", "0", "208", },
    id_4 = {"1", "53", "120201", "4", "4", "54", "56", "55", "57", "0", "0", "0", "0", "0", "0", "1", },
    id_5 = {"1", "72", "120202", "4", "5", "73", "75", "76", "77", "74", "0", "0", "0", "0", "0", "17", },
    id_6 = {"1", "20", "120303", "4", "6", "21", "23", "25", "24", "22", "0", "0", "0", "0", "0", "208", },
    id_7 = {"1", "67", "120301", "4", "7", "68", "71", "70", "69", "0", "0", "0", "0", "0", "0", "1", },
    id_8 = {"1", "28", "120302", "4", "8", "30", "32", "31", "26", "27", "29", "0", "0", "0", "0", "17", },
    id_9 = {"1", "41", "120304", "4", "9", "42", "44", "43", "45", "0", "0", "0", "0", "0", "0", "232", },
    id_10 = {"1", "48", "120303", "4", "10", "50", "52", "51", "49", "0", "0", "0", "0", "0", "0", "208", },
    id_11 = {"1", "78", "120303", "4", "11", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "208", },
    id_12 = {"1", "79", "120301", "4", "12", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_13 = {"1", "18", "120302", "4", "13", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "17", },
    id_14 = {"1", "189", "120102", "4", "14", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "17", },
    id_15 = {"1", "228", "120103", "4", "15", "229", "230", "0", "0", "0", "0", "0", "0", "0", "0", "208", },
    id_16 = {"1", "193", "120204", "4", "16", "195", "194", "0", "0", "0", "0", "0", "0", "0", "0", "232", },
    id_17 = {"1", "172", "120203", "4", "17", "174", "173", "175", "0", "0", "0", "0", "0", "0", "0", "208", },
    id_18 = {"1", "181", "120201", "4", "18", "186", "185", "184", "183", "182", "0", "0", "0", "0", "0", "1", },
    id_19 = {"1", "176", "120301", "4", "19", "178", "177", "179", "180", "0", "0", "0", "0", "0", "0", "1", },
    id_20 = {"1", "220", "120302", "4", "20", "222", "221", "223", "0", "0", "0", "0", "0", "0", "0", "17", },
    id_21 = {"1", "211", "120304", "4", "21", "212", "213", "215", "214", "0", "0", "0", "0", "0", "0", "232", },
    id_22 = {"1", "207", "120305", "4", "22", "208", "209", "210", "0", "0", "0", "0", "0", "0", "0", "233", },
    id_23 = {"1", "216", "120301", "4", "23", "219", "218", "217", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_24 = {"1", "234", "120304", "4", "24", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "232", },
    id_25 = {"1", "198", "120303", "4", "25", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "208", },
    id_26 = {"1", "170", "120301", "4", "26", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_27 = {"1", "105", "120103", "4", "27", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "208", },
    id_28 = {"1", "104", "120101", "4", "28", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_29 = {"1", "106", "120202", "4", "29", "108", "110", "109", "107", "0", "0", "0", "0", "0", "0", "17", },
    id_30 = {"1", "130", "120204", "4", "30", "131", "133", "134", "132", "0", "0", "0", "0", "0", "0", "232", },
    id_31 = {"1", "120", "120205", "4", "31", "121", "123", "122", "0", "0", "0", "0", "0", "0", "0", "233", },
    id_32 = {"1", "111", "120302", "4", "32", "113", "114", "112", "0", "0", "0", "0", "0", "0", "0", "17", },
    id_33 = {"1", "150", "120304", "4", "33", "152", "151", "154", "153", "0", "0", "0", "0", "0", "0", "232", },
    id_34 = {"1", "91", "120305", "4", "34", "95", "94", "92", "93", "0", "0", "0", "0", "0", "0", "233", },
    id_35 = {"1", "86", "120306", "4", "35", "90", "89", "87", "88", "0", "0", "0", "0", "0", "0", "231", },
    id_36 = {"1", "115", "120306", "4", "36", "116", "117", "119", "118", "0", "0", "0", "0", "0", "0", "231", },
    id_37 = {"1", "155", "120302", "4", "37", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "17", },
    id_38 = {"1", "139", "120304", "4", "38", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "232", },
    id_39 = {"1", "256", "120305", "4", "39", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "233", },
    id_40 = {"2", "33", "130101", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_41 = {"2", "33", "130102", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_42 = {"2", "33", "130103", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_43 = {"2", "33", "130104", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_44 = {"2", "33", "130105", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_45 = {"2", "33", "130106", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_46 = {"2", "33", "130107", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_47 = {"2", "33", "130108", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_48 = {"2", "33", "130109", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_49 = {"2", "33", "130110", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_50 = {"2", "124", "130201", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_51 = {"2", "124", "130202", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_52 = {"2", "124", "130203", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_53 = {"2", "124", "130204", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_54 = {"2", "124", "130205", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_55 = {"2", "124", "130206", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_56 = {"2", "124", "130207", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_57 = {"2", "124", "130208", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_58 = {"2", "124", "130209", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_59 = {"2", "124", "130210", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_60 = {"2", "231", "130301", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_61 = {"2", "231", "130302", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_62 = {"2", "231", "130303", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_63 = {"2", "231", "130304", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_64 = {"2", "231", "130305", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_65 = {"2", "231", "130306", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_66 = {"2", "231", "130307", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_67 = {"2", "231", "130308", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_68 = {"2", "231", "130309", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
    id_69 = {"2", "231", "130310", "4", "2", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", },
}


function getDataById(key_id)
    local id_data = mistyTable["id_" .. key_id]
    if id_data == nil then
        return nil
    end
    return id_data
end

function getArrDataByField(fieldName, fieldValue)
    local arrData = {}
    local fieldNo = 1
    for i=1, #keys do
        if keys[i] == fieldName then
            fieldNo = i
            break
        end
    end

    for k, v in pairs(mistyTable) do
        if tostring(v[fieldNo-1]) == tostring(fieldValue) then
            table.insert(arrData, copyTab(v))
        end
    end

    return arrData
end

function getTable()
    return mistyTable
end


function getFieldByIdAndIndex(key_id, fieldName)
    local fieldNo = 0
    for i=1, #keys do
        if keys[i] == fieldName then
            fieldNo = i-1
            break
        end
    end
    return getDataById(key_id)[fieldNo]
end


function getIndexByField(fieldName)
    local fieldNo = 0
    for i=1, #keys do
        if keys[i] == fieldName then
            fieldNo = i-1
            break
        end
    end
    return fieldNo
end


function getArrDataBy2Field(fieldName1, fieldValue1, fieldName2, fieldValue2)
	local arrData = {}
	local fieldNo1 = 1
	local fieldNo2 = 1
	for i=1, #keys do
		if keys[i] == fieldName1 then
			fieldNo1 = i
		end
		if keys[i] == fieldName2 then
			fieldNo2 = i
		end
	end

    for k, v in pairs(mistyTable) do
        if tostring(v[fieldNo1-1]) == tostring(fieldValue1) and tostring(v[fieldNo2-1]) == tostring(fieldValue2)  then
            table.insert(arrData, copyTab(v))
        end
    end

    return arrData
end



function release()
    _G["misty"] = nil
    package.loaded["misty"] = nil
end
